ARG NGINX_REPO=nginx \
    NGINX_VERSION=latest

# hadolint ignore=DL3006
FROM "${NGINX_REPO}:${NGINX_VERSION}"

ARG NGINX_VERSION

LABEL maintainer="Agibalov Sergei <agibse@rarus.ru>" \
    version="${NGINX_VERSION}" \
    manufacturer="Nginx"

COPY [ "stream.conf", "/etc/nginx/" ]

# hadolint ignore=SC1091
RUN --mount=from=context,target=/context \
    --mount=from=context_arg,target=/context_arg \
    set -eux; \
    . context/post_install; \
    set_startup